<!-- …your existing <body> content… -->

  <!-- move your inline script into a DOMContentLoaded wrapper -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // ===== your existing JS from calculate(), renderInstruments(), init(), etc. =====
      // for example:

      function renderInstruments(){
        instEl.innerHTML = '';
        instruments.forEach(i => {
          const opt = document.createElement('option');
          opt.value = i.symbol;
          opt.textContent = `${i.symbol} ($${i.value}/pt)`;
          instEl.appendChild(opt);
        });
      }

      // … all your other function definitions …

      // finally, bind events and initialize
      instEl.addEventListener('change', clearFields);
      [acctEl,typeEl,amtEl,dirEl,instEl,lvlEl,atrEl,entEl,rrEl]
        .forEach(e => e.addEventListener('input', calculate));
      saveBtn.onclick = savePreset;
      exportBtn.onclick = exportHistory;
      themeBtn.onclick = toggleTheme;

      // initial render & registration
      renderInstruments();
      renderPresets();
      renderHistory();
      calculate();
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js');
      }
    });
  </script>
</body>
</html>